<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Carte interactive des clients</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
    #map { height: 60vh; width: 100%; }
    .controls { padding: 1rem; background: #f9f9f9; display: flex; gap: 1rem; flex-wrap: wrap; }
    .controls > div { display: flex; flex-direction: column; gap: 0.5rem; }
    button { padding: 0.5rem 1rem; }
    #clientsTable { border-collapse: collapse; width: 100%; margin-top: 0.5rem; }
    #clientsTable th, #clientsTable td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }
    #clientsTable th { background: #eee; }
  </style>
</head>
<body>
  <div class="controls">
    <div>
      <label for="clientName"><strong>Nom du client</strong></label>
      <input type="text" id="clientName" placeholder="Ex. Client Dupont" />
    </div>
    <div>
      <label for="departmentsSelect"><strong>Départements</strong> (Ctrl+clic pour multi)</label>
      <select id="departmentsSelect" multiple size="6" style="min-width:200px;"></select>
    </div>
    <div style="align-self:flex-end;">
      <button id="addClient">Ajouter client</button>
    </div>
  </div>

  <div style="padding: 0 1rem;">
    <strong>Liste des clients</strong>
    <table id="clientsTable">
      <thead>
        <tr><th>Client</th><th>Départements</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div id="map"></div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const departmentsList = [
        {"code":"01","nom":"Ain"},{"code":"02","nom":"Aisne"},{"code":"03","nom":"Allier"},
        {"code":"04","nom":"Alpes-de-Haute-Provence"},{"code":"05","nom":"Hautes-Alpes"},
        {"code":"06","nom":"Alpes-Maritimes"},{"code":"07","nom":"Ardèche"},{"code":"08","nom":"Ardennes"},
        {"code":"09","nom":"Ariège"},{"code":"10","nom":"Aube"},{"code":"11","nom":"Aude"},
        {"code":"12","nom":"Aveyron"},{"code":"13","nom":"Bouches-du-Rhône"},{"code":"14","nom":"Calvados"},
        {"code":"15","nom":"Cantal"},{"code":"16","nom":"Charente"},{"code":"17","nom":"Charente-Maritime"},
        {"code":"18","nom":"Cher"},{"code":"19","nom":"Corrèze"},{"code":"2A","nom":"Corse-du-Sud"},
        {"code":"2B","nom":"Haute-Corse"},{"code":"21","nom":"Côte-d'Or"},{"code":"22","nom":"Côtes-d'Armor"},
        {"code":"23","nom":"Creuse"},{"code":"24","nom":"Dordogne"},{"code":"25","nom":"Doubs"},
        {"code":"26","nom":"Drôme"},{"code":"27","nom":"Eure"},{"code":"28","nom":"Eure-et-Loir"},
        {"code":"29","nom":"Finistère"},{"code":"30","nom":"Gard"},{"code":"31","nom":"Haute-Garonne"},
        {"code":"32","nom":"Gers"},{"code":"33","nom":"Gironde"},{"code":"34","nom":"Hérault"},
        {"code":"35","nom":"Ille-et-Vilaine"},{"code":"36","nom":"Indre"},{"code":"37","nom":"Indre-et-Loire"},
        {"code":"38","nom":"Isère"},{"code":"39","nom":"Jura"},{"code":"40","nom":"Landes"},
        {"code":"41","nom":"Loir-et-Cher"},{"code":"42","nom":"Loire"},{"code":"43","nom":"Haute-Loire"},
        {"code":"44","nom":"Loire-Atlantique"},{"code":"45","nom":"Loiret"},{"code":"46","nom":"Lot"},
        {"code
